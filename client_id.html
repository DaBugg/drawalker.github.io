<!doctype html>
<html>
<body>
<button id="login">Login with Spotify</button>
<pre id="out"></pre>
<script>
const CLIENT_ID = 'c204b7df4d884c0e88fc1d5de9b50000';
const REDIRECT_URI = 'http://127.0.0.1:5500/callback.html';
const SCOPES = ['user-read-currently-playing','user-read-playback-state'];
const RESPONSE_TYPE = 'token'; // implicit grant


document.getElementById('login').onclick = () => {
  const url = new URL('https://accounts.spotify.com/authorize');
  url.searchParams.set('client_id', CLIENT_ID);
  url.searchParams.set('response_type', 'token'); // Implicit Grant
  url.searchParams.set('redirect_uri', REDIRECT_URI);
  url.searchParams.set('scope', SCOPES.join(' '));
  window.location = url.toString();
};

// handle the callback
if (location.hash.includes('access_token')) {
  const params = new URLSearchParams(location.hash.slice(1));
  const token = params.get('access_token');
  document.getElementById('out').textContent = 'Token: ' + token;
  // Clean the hash
  history.replaceState({}, '', location.pathname);
}
</script>
</body>
</html>
